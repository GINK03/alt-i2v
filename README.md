# Alternative Implementation Of Illustration2Vec Ver2.

## Illustration2Vecの概要
- 画像をタグ等の特定の特徴量に従ってベクトル化できる
- このベクトルとは通常画像分類で用いられるsoftmaxなどのマルチクラスではなく、softprobの(\*1)問題として捉えることができる

\*1 softprobはxgboostの用語でありますが、各クラスに該当するものが、その確率値を返すものです  

## VGG16の転移学習
VGG16の評価モデルはよくチューニングされており、別段何かしなくても良いパフォーマンスが出せます  
そのため、VGG16の評価モデルを転移学習することでそのチューニングされた良い状態を保存しつつ、softprobに該当する部分を付け足すことで、illustration2vecに該当する機能を付与させます

## モデル図

## 転移学習時のネットワーク設計
今回は過去最大の5000次元を予想するというタスクであったので、全結合層をReLuで結合していきます  
前回はBatchNormalizationのみでやったのですが、これだけを用いうることに少し不安があったので、DropOutを30%のデータを入れるようにしました  
ReLu, DropOutともネットワークを疎結合にする役割が期待できますので、ネットワークの意味のクラスタが獲得しやすくなると期待できます  


## オプティマイザ  
これ系のタスクではAdamかSGDが良い成績をいつも収めることが期待されていますので、何も考えず、Adamで決め打ちです  
- Adam : LearningRate 0.001

## 使ったデータセット
Safebooruさんからダウンロードさせていただきました  
タグとURLと画像の三つの情報を保存し、学習用のデータセット1,500,000枚、テスト様に20,000枚用意します  

## データがメモリに乗り切らないときに使ったアプローチ
メモリに乗らないときは、最近いつも使うのですが、データセットを分割読み込みまします  
ソフトウェア工学者にとっては一般的なアプローチですが、Epochと対応させて学習すると、なんとかスケジューリングできます(ちゃんとKerasのインターフェースの中にはgeneratorというデータセットを切り出す仕組みがありますが、私はこれを操作が複雑になりすぎると感じているであまり用いていません)  

具体的には、15000枚の画像をオンメモリに保持 -> 1Epoch回す -> 別の150000枚の画像をオンメモリに保持 -> 1Epoch回す -> ...
  
ということを続けていきます

全てが一回のみスキャンされます
